---
title: "Типы DDoS-атак: L3, L4, L7 — чем отличаются и как защититься"
slug: tipy-ddos-atak-l3-l4-l7
description: "Подробный разбор типов DDoS-атак по уровням OSI: L3 (сетевой), L4 (транспортный), L7 (прикладной). Сравнительная таблица, методы защиты для каждого уровня."
keywords:
  - типы ddos атак
  - l3 l4 l7 атаки
  - классификация ddos
  - уровни ddos атак
  - ddos по osi
date: 2025-07-14
---

# Типы DDoS-атак: L3, L4, L7 — чем отличаются и как защититься

Когда говорят «DDoS-атака», подразумевают десятки разных техник. UDP Flood и HTTP Flood — это совершенно разные угрозы, которые требуют разных методов защиты. Файрвол, отлично фильтрующий SYN Flood, бесполезен против Slowloris.

Чтобы выбрать правильную защиту, нужно понимать классификацию. DDoS-атаки делят по уровням модели OSI — L3, L4 и L7. Разберём каждый тип: как работает, чем опасен и как от него защититься.

## Модель OSI: 30 секунд теории

OSI (Open Systems Interconnection) — эталонная модель, описывающая 7 уровней сетевого взаимодействия. Для понимания DDoS-атак достаточно трёх:

- **L3 (Network / Сетевой)** — маршрутизация пакетов между сетями. Протоколы: IP, ICMP, IGMP.
- **L4 (Transport / Транспортный)** — доставка данных между приложениями. Протоколы: TCP, UDP.
- **L7 (Application / Прикладной)** — взаимодействие с пользовательскими приложениями. Протоколы: HTTP, HTTPS, DNS, SMTP.

Чем выше уровень — тем «умнее» атака. L3-атаки бьют объёмом, L7-атаки имитируют легитимных пользователей. Защита на каждом уровне принципиально различается.

## L3-атаки: сетевой уровень

L3-атаки нацелены на сетевую инфраструктуру. Их задача — забить канал или вывести из строя маршрутизаторы и коммутаторы.

### ICMP Flood (Ping Flood)

Атакующий отправляет огромное количество ICMP Echo Request (ping) пакетов. Сервер обязан ответить на каждый ICMP Echo Reply. При достаточном объёме канал жертвы полностью забивается ответами.

**Характеристики:**
- Мощность: до нескольких сотен Гбит/с
- Сложность реализации: низкая
- Обнаружение: простое — аномальный объём ICMP-трафика

**Защита:** Ограничение скорости ICMP на маршрутизаторе или полная блокировка ICMP Echo на периметре. Для большинства сервисов входящий ping не критичен.

### UDP Flood

Массовая отправка UDP-датаграмм на случайные или целевые порты. Сервер проверяет, есть ли приложение, слушающее каждый порт, и если нет — отправляет ICMP Destination Unreachable. Это тратит и канал, и вычислительные ресурсы.

**Характеристики:**
- Мощность: до нескольких Тбит/с (при использовании амплификации)
- Сложность реализации: низкая
- Обнаружение: по аномальному объёму UDP-трафика

**Защита:** Блокировка UDP-трафика на неиспользуемых портах. Если ваш сервис не использует UDP (а большинство веб-приложений не используют), весь UDP-трафик можно безопасно отфильтровать.

### DNS/NTP/Memcached Amplification

Атаки с усилением (amplification) — отдельный класс L3-угроз. Атакующий отправляет небольшой запрос на публичный сервер (DNS, NTP, memcached) с подменённым IP-адресом жертвы. Сервер отвечает пакетом, в десятки раз большим, и направляет его жертве.

Коэффициенты усиления:
- DNS — до 70x
- NTP — до 556x
- Memcached — до 51 000x

Атака memcached amplification мощностью 1,35 Тбит/с обрушила GitHub в 2018 году. Входящий запрос атакующего: ~200 байт. Ответ, прилетевший жертве: ~100 КБ.

**Защита:** На стороне жертвы — только фильтрация на уровне провайдера. BGP-based перенаправление трафика через скрабинг-центры — стандартное решение для amplification-атак.

## L4-атаки: транспортный уровень

L4-атаки эксплуатируют механизмы TCP/UDP. Их цель — исчерпать ресурсы сервера, связанные с управлением соединениями.

### SYN Flood

Самая распространённая L4-атака. Эксплуатирует механизм TCP three-way handshake (тройное рукопожатие).

Нормальный процесс:
1. Клиент → SYN → Сервер
2. Сервер → SYN-ACK → Клиент
3. Клиент → ACK → Сервер (соединение установлено)

При SYN Flood атакующий отправляет миллионы SYN-пакетов с поддельными IP-адресами. Сервер создаёт полуоткрытое соединение для каждого, отправляет SYN-ACK и ждёт ACK, который никогда не придёт. Таблица соединений переполняется — новые легитимные подключения невозможны.

**Характеристики:**
- Мощность: до 200+ млн пакетов в секунду
- Цель: таблица TCP-соединений (обычно 128 000–1 000 000 записей)
- Сложность обнаружения: средняя

**Защита:**
- SYN Cookies — сервер не выделяет ресурсы до завершения handshake
- Увеличение backlog queue
- Уменьшение таймаута для полуоткрытых соединений
- Фильтрация на уровне [анти-DDoS решения](/anti-ddos)

### ACK Flood

Массовая отправка TCP ACK-пакетов. Сервер тратит ресурсы на проверку каждого ACK — существует ли соединение, к которому он относится. При достаточном объёме CPU сервера перегружается проверками.

**Характеристики:**
- Мощность: до нескольких десятков Гбит/с
- Цель: CPU сервера и stateful-файрволы
- Сложность обнаружения: средняя — ACK-пакеты выглядят нормально поодиночке

**Защита:** Stateless-фильтрация на границе сети, challenge-response механизмы.

### TCP RST Flood

Отправка массы TCP RST (Reset) пакетов, разрывающих существующие соединения. Особенно опасна для сервисов с долгоживущими соединениями (WebSocket, стриминг).

**Защита:** Проверка sequence numbers TCP-пакетов, фильтрация RST-пакетов, не соответствующих активным сессиям.

### TCP Fragment Attack

Отправка фрагментированных TCP-пакетов, которые невозможно собрать. Сервер выделяет память под каждый фрагмент и ждёт остальные части. Память исчерпывается.

**Защита:** Лимитирование фрагментированных пакетов, настройка таймаутов сборки фрагментов.

## L7-атаки: прикладной уровень

L7-атаки — самые сложные для обнаружения и фильтрации. Каждый отдельный запрос выглядит абсолютно легитимным. Проблема — в их количестве или в целенаправленном выборе «тяжёлых» точек приложения.

### HTTP Flood

Массовая отправка HTTP GET или POST запросов. Два подтипа:

**HTTP GET Flood** — запросы к ресурсоёмким страницам: поиск, фильтрация каталога, генерация отчётов. Каждый запрос заставляет сервер обращаться к базе данных, выполнять вычисления, генерировать HTML.

**HTTP POST Flood** — отправка форм: регистрация, добавление в корзину, загрузка файлов. POST-запросы обычно «тяжелее» для сервера.

**Характеристики:**
- Мощность: от 10 000 до 500+ млн запросов в секунду
- Цель: веб-сервер, база данных, бэкенд
- Сложность обнаружения: высокая — каждый запрос выглядит нормально

**Защита:** [Web Application Firewall (WAF)](/waf) с поведенческим анализом, JavaScript-challenge, CAPTCHA для подозрительных сессий, rate limiting по сессиям.

### Slowloris

Атака удерживает максимальное количество HTTP-соединений открытыми, отправляя HTTP-заголовки по одному байту с большими интервалами. Сервер ждёт завершения запроса, держа соединение открытым. Когда пул соединений исчерпан — новые подключения невозможны.

**Характеристики:**
- Мощность: достаточно нескольких тысяч соединений
- Цель: пул соединений веб-сервера (Apache особенно уязвим)
- Сложность обнаружения: высокая — трафик минимальный

**Защита:** Настройка таймаутов для HTTP-заголовков, использование event-driven серверов (nginx вместо Apache), ограничение соединений с одного IP, WAF.

### API Abuse

Целенаправленные запросы к «тяжёлым» API-endpoint'ам. Атакующий находит endpoint, который выполняет сложный SQL-запрос или ресурсоёмкую операцию, и забрасывает его запросами.

**Пример:** Поисковый endpoint, который при определённых параметрах выполняет full-table scan базы данных. 100 таких запросов в секунду — и база лежит.

**Защита:** Rate limiting по endpoint'ам, кэширование результатов, оптимизация «тяжёлых» запросов, WAF.

## Сравнительная таблица

| Параметр | L3 | L4 | L7 |
|---|---|---|---|
| Уровень OSI | Сетевой | Транспортный | Прикладной |
| Цель атаки | Канал, маршрутизаторы | Таблица соединений, CPU | Веб-сервер, БД, бэкенд |
| Типичная мощность | 100 Гбит/с — 2+ Тбит/с | 10–200 млн pps | 10K — 500M+ rps |
| Сложность реализации | Низкая | Средняя | Высокая |
| Сложность обнаружения | Низкая | Средняя | Высокая |
| IP-спуфинг | Да | Часто | Редко |
| Пример | UDP Flood, Amplification | SYN Flood, ACK Flood | HTTP Flood, Slowloris |
| Основная защита | BGP-фильтрация, scrubbing | SYN Cookies, stateless-фильтры | WAF, поведенческий анализ |

## Методы защиты по уровням

### Защита от L3-атак

L3-атаки берут объёмом. Ваш сервер с каналом 1 Гбит/с физически не может отфильтровать 500 Гбит/с входящего трафика — пакеты просто не дойдут. Защита должна быть выше, на уровне провайдера или специализированного скрабинг-центра.

Эффективные методы:
- **BGP-перенаправление** — трафик направляется через центры очистки с пропускной способностью в несколько Тбит/с
- **Blackhole routing** — дропание трафика на уровне провайдера (крайняя мера — теряется и легитимный трафик)
- **ACL на маршрутизаторах** — базовая фильтрация по протоколам и портам
- **FlowSpec** — динамическое обновление правил фильтрации через BGP

### Защита от L4-атак

L4-атаки сложнее L3, но обнаруживаются по аномалиям в TCP/UDP-потоке.

Эффективные методы:
- **SYN Cookies** — серверу не нужно хранить состояние до завершения handshake
- **Connection rate limiting** — ограничение новых соединений с одного IP
- **TCP proxy** — промежуточный сервер завершает TCP handshake перед пересылкой на бэкенд
- **Hardware-based фильтрация** — специализированные устройства, обрабатывающие миллионы pps

[Профессиональная защита от DDoS](/anti-ddos) включает фильтрацию на L3/L4 уровне с автоматическим обнаружением аномалий.

### Защита от L7-атак

L7 — самый сложный уровень для защиты. Нельзя просто заблокировать трафик по IP или протоколу — запросы выглядят легитимно.

Эффективные методы:
- **[WAF (Web Application Firewall)](/waf)** — анализирует HTTP-запросы, применяет правила и поведенческий анализ
- **JavaScript Challenge** — браузер должен выполнить JS-код перед доступом к сайту. Боты, не умеющие выполнять JS, отсекаются.
- **CAPTCHA** — для подозрительных сессий
- **Fingerprinting** — идентификация ботов по характеристикам TLS, HTTP-заголовков, поведению
- **Machine Learning** — обучение на нормальном трафике для выявления аномалий

## Мультивекторные атаки

Современные атаки редко используют один метод. Типичный сценарий:

1. **Отвлекающий удар** — L3 volumetric-атака, которая заставляет команду сконцентрироваться на фильтрации объёмного трафика
2. **Основной удар** — L7-атака, которая проходит через защиту, пока все смотрят на графики bandwidth

По данным Akamai, 65% DDoS-атак в 2024 году были мультивекторными. Это означает, что защита должна работать на всех уровнях одновременно.

## Как выбрать защиту

Ответьте на три вопроса:

1. **Какой тип трафика у вас преобладает?** Если у вас веб-приложение — L7-защита критична. Если игровой сервер на UDP — фокус на L3/L4.

2. **Какой максимальный объём атаки вы ожидаете?** Если ваш сайт может стать целью крупной атаки — нужна защита с ёмкостью в несколько Тбит/с на L3.

3. **Насколько критичен даунтайм?** Для сайта-визитки 15 минут простоя — неприятность. Для платёжного сервиса — катастрофа. Уровень защиты должен соответствовать стоимости простоя.

## Подключите защиту за 24 часа — бесплатно

Универсальной защиты «от всего» не существует. Но существует комплексный подход — фильтрация на всех уровнях (L3 + L4 + L7) с единой точкой управления.

AntiDDoS.su предоставляет [многоуровневую защиту от DDoS](/anti-ddos) с фильтрацией от L3 до L7 и [WAF](/waf) для защиты на прикладном уровне. Подключение — за 24 часа, тестовый период — бесплатно.

Оцените свои риски, выберите уровень защиты, который им соответствует, и не откладывайте подключение на «после первой атаки».
